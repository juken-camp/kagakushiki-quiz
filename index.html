<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üß™ ÂåñÂ≠¶Âºè„ÇØ„Ç§„Ç∫ - ËªΩÂø´„Å™ÂåñÂ≠¶Âºè„Ç≤„Éº„É† üß™</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;800&family=Nunito:wght@600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #5b37e0;
            --primary-light: #8b6ef5;
            --primary-pale: #ede9ff;
            --accent-gold: #f59e0b;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-blue: #3b82f6;
            --accent-pink: #ec4899;
            --bg: #f8f6ff;
            --bg-card: #ffffff;
            --surface: rgba(255,255,255,0.92);
            --text: #2d1b69;
            --text-sub: #7c6fa0;
            --text-hint: #b8adcc;
            --border: rgba(91,55,224,0.12);
            --shadow: 0 4px 20px rgba(91,55,224,0.12);
            --shadow-sm: 0 2px 8px rgba(91,55,224,0.1);
        }

        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background: var(--bg);
            color: var(--text);
            font-weight: 700;
            height: 100vh;
            height: 100dvh;
            touch-action: manipulation;
            overflow: hidden;
            position: fixed;
            width: 100%;
        }

        /* ËÉåÊôØ„ÅÆË£ÖÈ£æ */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background:
                radial-gradient(circle at 15% 20%, rgba(139,110,245,0.08) 0%, transparent 40%),
                radial-gradient(circle at 85% 80%, rgba(236,72,153,0.06) 0%, transparent 40%);
            pointer-events: none;
            z-index: 0;
        }

        .kawaii-container {
            height: 100vh;
            height: 100dvh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        /* ===== HEADER ===== */
        .header {
            background: var(--surface);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
            border-radius: 0 0 20px 20px;
            padding: 10px 14px 12px;
            flex-shrink: 0;
            position: relative;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        /* „Çø„Ç§„Éà„É´Ë°å */
        .title-area {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .game-title {
            font-family: 'Nunito', 'M PLUS Rounded 1c', sans-serif;
            font-size: 1.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent-pink));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .chemistry-icon {
            font-size: 1em;
            -webkit-text-fill-color: initial;
        }

        /* „Çπ„Ç≥„Ç¢ */
        .score-area {
            display: flex;
            gap: 5px;
        }

        .score-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--primary-pale);
            border-radius: 8px;
            padding: 3px 8px;
            min-width: 42px;
        }

        .score-number {
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
        }

        .score-label {
            font-size: 0.58rem;
            color: var(--text-sub);
            line-height: 1.2;
        }

        #comboScore .score-number { color: var(--accent-gold); }
        #comboScore { background: #fff8e6; }

        /* ===== BUTTONS AREA ===== */
        .buttons-area {
            display: flex;
            flex-direction: column;
            gap: 7px;
        }

        /* „É¢„Éº„Éâ„Éú„Çø„É≥ */
        .mode-selector {
            display: flex;
            gap: 5px;
        }

        .mode-btn {
            flex: 1;
            background: white;
            border: 1.5px solid var(--border);
            border-radius: 10px;
            padding: 5px 3px;
            cursor: pointer;
            color: var(--text-sub);
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-weight: 700;
            font-size: 0.58rem;
            text-align: center;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            box-shadow: var(--shadow-sm);
        }

        .mode-btn:hover {
            border-color: var(--primary-light);
            color: var(--primary);
            transform: translateY(-1px);
        }

        .mode-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(91,55,224,0.3);
        }

        .mode-btn.mixed-mode {
            background: linear-gradient(135deg, #fff8e6, #fff3cd);
            border-color: rgba(245,158,11,0.3);
            color: #92650a;
        }

        .mode-btn.mixed-mode.active {
            background: linear-gradient(135deg, var(--accent-gold), #f59e0b);
            border-color: var(--accent-gold);
            color: white;
            box-shadow: 0 4px 12px rgba(245,158,11,0.3);
        }

        .mode-icon { font-size: 1.1em; line-height: 1; }
        .mode-text { font-size: 1em; line-height: 1.2; }

        /* „Ç≥„É≥„Éà„É≠„Éº„É´„Éú„Çø„É≥ */
        .controls {
            display: flex;
            gap: 5px;
        }

        .control-btn {
            flex: 1;
            height: 48px;
            border-radius: 12px;
            border: none;
            color: white;
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-size: 0.62rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            box-shadow: var(--shadow-sm);
        }

        .control-btn:hover { filter: brightness(1.08); transform: translateY(-1px); }
        .control-btn:active { transform: scale(0.95); filter: brightness(0.95); }

        .btn-check  { background: linear-gradient(135deg, #059669, #10b981); }
        .btn-clear  { background: linear-gradient(135deg, #dc2626, #ef4444); }
        .btn-hint   { background: linear-gradient(135deg, #d97706, #f59e0b); }
        .btn-next   { background: linear-gradient(135deg, #1d4ed8, #3b82f6); }
        .btn-answer { background: linear-gradient(135deg, var(--primary), var(--primary-light)); }

        .control-icon { font-size: 1.35em; line-height: 1; }
        .control-text { font-size: 0.9em; line-height: 1; }

        /* ===== GAME AREA ===== */
        .game-area {
            flex: 1;
            overflow: hidden;
            margin: 10px 10px 0;
            border-radius: 18px;
            background: rgba(255,255,255,0.5);
            border: 1px solid var(--border);
            position: relative;
        }

        .cards-section {
            width: 100%;
            height: 100%;
            border-radius: 18px;
            overflow: hidden;
            position: relative;
        }

        /* ===== ANSWER SECTION ===== */
        .answer-section {
            background: white;
            margin: 10px;
            padding: 14px 16px;
            border-radius: 16px;
            border: 2px dashed var(--border);
            min-height: 110px;
            max-height: 170px;
            transition: all 0.3s ease;
            position: relative;
            z-index: 800;
            overflow-y: auto;
            flex-shrink: 0;
            box-shadow: var(--shadow-sm);
        }

        .answer-section.has-answer {
            border-color: var(--accent-green);
            border-style: solid;
            background: rgba(16,185,129,0.04);
        }

        .answer-section.correct-state {
            border-color: var(--accent-gold);
            background: rgba(245,158,11,0.06);
            animation: correct-glow 1.8s ease-in-out infinite;
        }

        @keyframes correct-glow {
            0%, 100% { box-shadow: var(--shadow-sm); }
            50% { box-shadow: 0 0 24px rgba(245,158,11,0.25); }
        }

        .question-in-answer {
            font-size: 0.88rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 10px;
            text-align: center;
            line-height: 1.4;
        }

        .answer-content {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 6px;
            min-height: 44px;
        }

        .answer-piece {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 7px 12px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 3px 10px rgba(91,55,224,0.25);
            cursor: pointer;
            transition: all 0.2s ease;
            animation: piece-appear 0.3s cubic-bezier(0.34,1.56,0.64,1);
            white-space: nowrap;
        }

        @keyframes piece-appear {
            0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .answer-piece:hover {
            filter: brightness(0.85);
            transform: scale(0.95);
        }

        .answer-piece.transforming {
            animation: piece-transform 0.8s ease-out forwards;
        }

        @keyframes piece-transform {
            0%   { background: linear-gradient(135deg, var(--primary), var(--primary-light)); }
            40%  { background: linear-gradient(135deg, var(--accent-gold), #f59e0b); transform: scale(1.3) rotate(180deg); }
            100% { background: linear-gradient(135deg, var(--accent-green), #059669); transform: scale(1) rotate(360deg); }
        }

        .correct-answer-display {
            background: linear-gradient(135deg, var(--accent-gold), #f59e0b);
            color: white;
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.15rem;
            box-shadow: 0 6px 20px rgba(245,158,11,0.3);
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
            animation: pop-in 0.5s cubic-bezier(0.34,1.56,0.64,1);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .answer-button-display {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.15rem;
            box-shadow: 0 6px 20px rgba(91,55,224,0.3);
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
            animation: pop-in 0.5s cubic-bezier(0.34,1.56,0.64,1);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        @keyframes pop-in {
            0% { transform: scale(0.6); opacity: 0; }
            70% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* ===== ATOM CARDS ‚Äî ‰∏∏ÂΩ¢ ===== */
        .atom-card {
            position: absolute;
            width: 58px;
            height: 58px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2em;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.18);
            border: 3px solid rgba(255,255,255,0.5);
            color: white;
            text-shadow: 0 1px 3px rgba(0,0,0,0.4);
            user-select: none;
            z-index: 100;
            touch-action: none;
            white-space: nowrap;
        }

        .atom-card.symbol-large { font-size: 1.4em; }

        .atom-card:hover {
            transform: scale(1.18) translateY(-3px);
            z-index: 200;
            box-shadow: 0 8px 22px rgba(0,0,0,0.25);
        }

        .atom-card.selected {
            transform: scale(1.35);
            z-index: 300;
            filter: brightness(1.2);
            animation: selected-pulse 0.5s ease-out;
        }

        @keyframes selected-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.55); }
            100% { transform: scale(1.35); }
        }

        .atom-card.dragging {
            z-index: 500;
            transform: scale(1.25);
            box-shadow: 0 12px 28px rgba(0,0,0,0.3);
            cursor: grabbing;
        }

        .atom-card.spawn-animation {
            animation: spawn-in 0.6s cubic-bezier(0.34,1.56,0.64,1);
        }

        @keyframes spawn-in {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            60% { transform: scale(1.15) rotate(200deg); opacity: 1; }
            100% { transform: scale(1) rotate(360deg); opacity: 1; }
        }

        .atom-card.floating {
            animation: float-gentle 3.5s ease-in-out infinite;
        }

        @keyframes float-gentle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-7px); }
        }

        /* ÂÖÉÁ¥†Âà•„Ç´„É©„Éº */
        .atom-hydrogen { background: linear-gradient(135deg, #ff6b6b, #ff8e53); }
        .atom-oxygen   { background: linear-gradient(135deg, #11998e, #38ef7d); }
        .atom-carbon   { background: linear-gradient(135deg, #4b4b4b, #717171); }
        .atom-nitrogen { background: linear-gradient(135deg, #1565c0, #42a5f5); }
        .atom-chlorine { background: linear-gradient(135deg, #2e7d32, #66bb6a); }
        .atom-sulfur   { background: linear-gradient(135deg, #e65100, #ff9800); }
        .atom-metal    { background: linear-gradient(135deg, #546e7a, #90a4ae); }
        .atom-number   { background: linear-gradient(135deg, #6a1b9a, #ab47bc); }
        .atom-special  { background: linear-gradient(135deg, #c62828, #ef5350); }
        .atom-ion      { background: linear-gradient(135deg, #006064, #26c6da); }

        /* ===== ‰∏ãÈÉ®„Çπ„Éö„Éº„Çπ ===== */
        .bottom-space { height: 8px; flex-shrink: 0; }

        /* ===== „Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ ===== */
        .feedback {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: white;
            padding: 12px 24px;
            border-radius: 16px;
            font-size: 0.92em;
            font-weight: 700;
            text-align: center;
            box-shadow: 0 12px 40px rgba(0,0,0,0.18);
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease, transform 0.25s ease;
            max-width: 85%;
            white-space: nowrap;
        }

        .feedback.show {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
            animation: feedback-pop 0.35s cubic-bezier(0.34,1.56,0.64,1);
        }

        @keyframes feedback-pop {
            0% { transform: translate(-50%, -50%) scale(0.5); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .feedback.correct {
            color: var(--accent-green);
            border: 2px solid rgba(16,185,129,0.3);
        }

        .feedback.incorrect {
            color: var(--accent-red);
            border: 2px solid rgba(239,68,68,0.3);
        }

        /* ===== „Éë„Éº„ÉÜ„Ç£„ÇØ„É´ ===== */
        .kawaii-particle {
            position: absolute;
            pointer-events: none;
            font-size: 1.3em;
            z-index: 2000;
            animation: particle-float 1.8s ease-out forwards;
        }

        @keyframes particle-float {
            0% { opacity: 1; transform: scale(0) rotate(0deg); }
            50% { opacity: 1; transform: scale(1.2) rotate(180deg); }
            100% { opacity: 0; transform: scale(0.5) rotate(360deg) translateY(-70px); }
        }

        /* ===== „ÅäÁ•ù„ÅÑ ===== */
        .celebration {
            position: fixed;
            inset: 0;
            background: rgba(91,55,224,0.15);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .celebration.show {
            display: flex;
            animation: fade-in 0.3s ease;
        }

        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }

        .celebration-content {
            background: white;
            padding: 32px 28px;
            border-radius: 24px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(91,55,224,0.2);
            animation: pop-in 0.5s cubic-bezier(0.34,1.56,0.64,1);
            max-width: 90%;
        }

        .celebration-content h2 {
            color: var(--primary);
            font-size: 1.5rem;
        }

        .celebration-content p {
            color: var(--text-sub);
            margin: 10px 0 16px;
            font-size: 0.9rem;
        }

        /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº */
        .answer-section::-webkit-scrollbar { width: 4px; }
        .answer-section::-webkit-scrollbar-track { background: transparent; }
        .answer-section::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

        /* ===== „É¨„Çπ„Éù„É≥„Ç∑„Éñ ===== */
        @media (max-width: 480px) {
            .mode-btn { font-size: 0.54rem; }
            .atom-card { width: 52px; height: 52px; font-size: 1.1em; }
            .control-btn { height: 44px; }
            .answer-section { min-height: 100px; max-height: 150px; padding: 12px; }
        }

        @media (max-height: 700px) {
            .atom-card { width: 50px; height: 50px; font-size: 1.05em; }
            .answer-section { min-height: 95px; max-height: 140px; }
            .control-btn { height: 42px; }
        }

        @media (max-height: 600px) {
            .atom-card { width: 45px; height: 45px; font-size: 0.95em; }
            .answer-section { min-height: 85px; max-height: 120px; padding: 10px; }
            .control-btn { height: 38px; font-size: 0.58rem; }
            .question-in-answer { font-size: 0.82rem; margin-bottom: 6px; }
        }

        @media (max-width: 390px) {
            .mode-btn { font-size: 0.5rem; }
            .control-btn { height: 40px; }
        }
    </style>
</head>
<body>
    <div class="kawaii-container">
        <div class="header">
            <div class="title-area">
                <h1 class="game-title" id="gameTitle">
                    <span class="chemistry-icon">üß™</span>
                    ÂåñÂ≠¶Âºè„ÇØ„Ç§„Ç∫
                    <span class="chemistry-icon">üß™</span>
                </h1>
                <div class="score-area">
                    <div class="score-item" id="correctScore">
                        <div class="score-number" id="correctCount">0</div>
                        <div class="score-label">Ê≠£Ëß£</div>
                    </div>
                    <div class="score-item" id="totalScore">
                        <div class="score-number" id="totalCount">0</div>
                        <div class="score-label">ÂïèÈ°å</div>
                    </div>
                    <div class="score-item" id="comboScore">
                        <div class="score-number" id="comboCount">0</div>
                        <div class="score-label">„Ç≥„É≥„Éú</div>
                    </div>
                </div>
            </div>

            <div class="buttons-area">
                <div class="mode-selector">
                    <button class="mode-btn" data-mode="elements">
                        <div class="mode-icon">üß™</div>
                        <div class="mode-text">ÂÖÉÁ¥†Ë®òÂè∑</div>
                    </button>
                    <button class="mode-btn" data-mode="compounds">
                        <div class="mode-icon">‚öóÔ∏è</div>
                        <div class="mode-text">ÂåñÂ≠¶Âºè</div>
                    </button>
                    <button class="mode-btn" data-mode="reactions">
                        <div class="mode-icon">üî¨</div>
                        <div class="mode-text">ÂåñÂ≠¶ÂèçÂøúÂºè</div>
                    </button>
                    <button class="mode-btn" data-mode="ions">
                        <div class="mode-icon">‚ö°</div>
                        <div class="mode-text">„Ç§„Ç™„É≥</div>
                    </button>
                    <button class="mode-btn" data-mode="ionicReactions">
                        <div class="mode-icon">üåê</div>
                        <div class="mode-text">„Ç§„Ç™„É≥ÂèçÂøúÂºè</div>
                    </button>
                    <button class="mode-btn mixed-mode" data-mode="mixed">
                        <div class="mode-icon">üéØ</div>
                        <div class="mode-text">ÂÖ®ÁØÑÂõ≤</div>
                    </button>
                </div>

                <div class="controls">
                    <button class="control-btn btn-check" id="checkBtn">
                        <div class="control-icon">‚úÖ</div>
                        <div class="control-text">Á≠î„ÅàÂêà„Çè„Åõ</div>
                    </button>
                    <button class="control-btn btn-clear" id="clearBtn">
                        <div class="control-icon">üóëÔ∏è</div>
                        <div class="control-text">„ÇØ„É™„Ç¢</div>
                    </button>
                    <button class="control-btn btn-hint" id="hintBtn">
                        <div class="control-icon">üí°</div>
                        <div class="control-text">„Éí„É≥„Éà</div>
                    </button>
                    <button class="control-btn btn-answer" id="answerBtn">
                        <div class="control-icon">üìñ</div>
                        <div class="control-text">Ê≠£Ëß£„ÇíË¶ã„Çã</div>
                    </button>
                    <button class="control-btn btn-next" id="nextBtn">
                        <div class="control-icon">‚û°Ô∏è</div>
                        <div class="control-text">Ê¨°„ÅÆÂïèÈ°å</div>
                    </button>
                </div>
            </div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="cards-section" id="cardsSection"></div>
        </div>

        <div class="answer-section" id="answerArea">
            <div class="question-in-answer" id="questionInAnswer">
                „Ç≤„Éº„É†„É¢„Éº„Éâ„ÇíÈÅ∏„Çì„Åß„Å≠ üíï
            </div>
            <div class="answer-content" id="answerContent">
                <div style="color: var(--text-hint); font-size: 0.88em;">„Ç´„Éº„Éâ„Çí„Çø„ÉÉ„Éó„Åó„Å¶ÂåñÂ≠¶Âºè„Çí‰Ωú„Çç„ÅÜ ‚ú®</div>
            </div>
        </div>

        <div class="bottom-space"></div>
        <div class="feedback" id="feedback"></div>

        <div class="celebration" id="celebration">
            <div class="celebration-content">
                <h2>üéâ Á¥†Êô¥„Çâ„Åó„ÅÑÔºÅ üéâ</h2>
                <p>ÂåñÂ≠¶„Éû„Çπ„Çø„Éº„Å´‰∏ÄÊ≠©Ëøë„Å•„ÅÑ„Åü„Å≠ÔºÅ</p>
                <button class="mode-btn" onclick="nextProblem()" style="margin: 0 auto; display: flex; max-width: 130px; padding: 8px 10px;">
                    <span>Ê¨°„ÅÆÂïèÈ°å„Å∏ ‚ú®</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // ÂåñÂ≠¶ÁöÑ„Å´Ê≠£Á¢∫„Å™„Ç≤„Éº„É†„Éá„Éº„ÇøÔºàË§áÊï∞Ê≠£Ëß£„Éë„Çø„Éº„É≥ÂØæÂøúÁâàÔºâ
const gameData = {
            // ÂÖÉÁ¥†Ë®òÂè∑ - Âü∫Êú¨„Åã„ÇâÂøúÁî®„Åæ„Åß
            elements: [
                { question: "„Ç¢„É´„Éü„Éã„Ç¶„É†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Al"]], pool: ["Au", "Ag", "Cu", "Fe", "Mg", "Ca", "K", "Na", "Zn", "Pb", "Sn", "Cr", "Mn", "Ti", "V"] },
                { question: "ÈäÄ„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Ag"]], pool: ["Au", "Cu", "Fe", "Zn", "Ni", "Co", "Pt", "Pd", "Rh", "Ir", "Os", "Ru", "Hg", "Cd", "Al"] },
                { question: "„Ç´„É™„Ç¶„É†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["K"]], pool: ["Na", "Li", "Rb", "Cs", "Ca", "Mg", "Ba", "Sr", "Al", "Ga", "In", "Tl", "Sn", "Pb", "Bi"] },
                { question: "„Ç´„É´„Ç∑„Ç¶„É†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Ca"]], pool: ["Mg", "Sr", "Ba", "Ra", "Sc", "Ti", "V", "Cr", "Mn", "Fe", "Co", "Ni", "Cu", "Zn", "Ga"] },
                { question: "Â°©Á¥†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Cl"]], pool: ["F", "Br", "I", "S", "P", "N", "O", "H", "C", "Na", "K", "Ca", "Mg", "Al", "Si"] },
                { question: "„ÇØ„É≠„É†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Cr"]], pool: ["Mn", "Fe", "Co", "Ni", "Cu", "Zn", "V", "Ti", "Sc", "Ca", "K", "Na", "Mg", "Al", "Si"] },
                { question: "ÈäÖ„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Cu"]], pool: ["Ag", "Au", "Zn", "Cd", "Hg", "Ni", "Co", "Fe", "Mn", "Cr", "V", "Ti", "Sc", "Ca", "K"] },
                { question: "ÈâÑ„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Fe"]], pool: ["Co", "Ni", "Cu", "Zn", "Mn", "Cr", "Ti", "V", "Sc", "Y", "Zr", "Nb", "Mo", "Tc", "Ru"] },
                { question: "Á™íÁ¥†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["N"]], pool: ["O", "F", "Ne", "Na", "Mg", "Al", "Si", "P", "S", "Cl", "Ar", "K", "Ca", "Sc", "Ti"] },
                { question: "„Éä„Éà„É™„Ç¶„É†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Na"]], pool: ["K", "Li", "Rb", "Cs", "Ca", "Mg", "Ba", "Sr", "Al", "Ga", "In", "Tl", "Sn", "Pb", "Bi"] },
                { question: "ÈÖ∏Á¥†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["O"]], pool: ["H", "C", "N", "F", "Ne", "Na", "Mg", "Al", "Si", "P", "S", "Cl", "Ar", "K", "Ca"] },
                { question: "„Éê„É™„Ç¶„É†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Ba"]], pool: ["Mg", "Ca", "Sr", "Ra", "K", "Na", "Li", "Rb", "Cs", "Al", "Ga", "In", "Tl", "Sc", "Ti"] },
                { question: "Ê∞¥Á¥†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["H"]], pool: ["He", "Li", "Be", "B", "C", "N", "O", "F", "Ne", "Na", "Mg", "Al", "Si", "P", "S"] },
                { question: "„Éû„Ç∞„Éç„Ç∑„Ç¶„É†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Mg"]], pool: ["Ca", "Sr", "Ba", "Ra", "K", "Na", "Li", "Rb", "Cs", "Al", "Ga", "In", "Tl", "Sc", "Ti"] },
                { question: "Á°´ÈªÑ„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["S"]], pool: ["O", "Se", "Te", "Po", "N", "P", "C", "H", "F", "Cl", "Br", "I", "Na", "K", "Fe"] },
                { question: "‰∫úÈâõ„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["Zn"]], pool: ["Cd", "Hg", "Cu", "Fe", "Co", "Ni", "Cr", "Mn", "V", "Ti", "Sc", "Ca", "K", "Na", "Mg"] },
                { question: "ÁÇ≠Á¥†„ÅÆÂÖÉÁ¥†Ë®òÂè∑„ÅØÔºü", answer: [["C"]], pool: ["H", "O", "N", "S", "P", "Cl", "Ar", "K", "Ca", "Sc", "Ti", "V", "Cr", "Mn", "Fe"] }
            ],

            // ÂåñÂ≠¶Âºè - ÂàÜÂ≠êÂºè„Åã„Çâ„Ç§„Ç™„É≥ÊÄßÂåñÂêàÁâ©„Åæ„Åß
            compounds: [
                { question: "„Ç¢„É≥„É¢„Éã„Ç¢„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["N", "H", "‚ÇÉ"]], pool: ["N", "H", "O", "C", "S", "P", "Cl", "F", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà"] },
                { question: "Â°©ÂåñÈäÖ„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Cu", "Cl", "‚ÇÇ"]], pool: ["Cu", "Cl", "Fe", "Zn", "Mg", "Ca", "K", "Na", "Ag", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ"] },
                { question: "Â°©ÂåñÊ∞¥Á¥†ÔºàÂ°©ÈÖ∏Ôºâ„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["H", "Cl"]], pool: ["H", "Cl", "F", "Br", "I", "O", "N", "C", "S", "P", "Na", "K", "Mg", "Ca", "Fe"] },
                { question: "Â°©Âåñ„Éä„Éà„É™„Ç¶„É†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Na", "Cl"]], pool: ["Na", "K", "Br", "I", "F", "Ca", "Mg", "Sr", "Ba", "Li", "Rb", "Cs", "Fr", "At", "H"] },
                { question: "ÈÖ∏ÂåñÈäÄ„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Ag", "‚ÇÇ", "O"]], pool: ["Ag", "O", "Cu", "Fe", "Zn", "Na", "K", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà"] },
                { question: "ÈÖ∏ÂåñÈäÖ„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Cu", "O"]], pool: ["Cu", "O", "S", "Fe", "Zn", "Na", "K", "Mg", "Ca", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá"] },
                { question: "ÈÖ∏Âåñ„Éû„Ç∞„Éç„Ç∑„Ç¶„É†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Mg", "O"]], pool: ["Mg", "O", "S", "Fe", "Zn", "Na", "K", "Ca", "Ba", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá"] },
                { question: "ÈÖ∏Á¥†ÂàÜÂ≠ê„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["O", "‚ÇÇ"]], pool: ["O", "H", "N", "C", "S", "P", "Cl", "F", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà"] },
                { question: "Ê∞¥ÂàÜÂ≠ê„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["H", "‚ÇÇ", "O"]], pool: ["H", "O", "N", "C", "S", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "Cl", "F", "Br", "I", "P"] },
                { question: "Ê∞¥ÈÖ∏Âåñ„Ç´„É™„Ç¶„É†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["K", "O", "H"]], pool: ["K", "O", "H", "Na", "Li", "Rb", "Cs", "Mg", "Ca", "Sr", "Ba", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ"] },
                { question: "Ê∞¥ÈÖ∏Âåñ„Éä„Éà„É™„Ç¶„É†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Na", "O", "H"]], pool: ["Na", "O", "H", "K", "Li", "Rb", "Cs", "Mg", "Ca", "Sr", "Ba", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ"] },
                { question: "Ê∞¥ÈÖ∏Âåñ„Éê„É™„Ç¶„É†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Ba", "(", "O", "H", ")", "‚ÇÇ"]], pool: ["Ba", "Ca", "Mg", "Sr", "K", "Na", "O", "H", "(", ")", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ"] },
                { question: "Á°´ÈÖ∏„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["H", "‚ÇÇ", "S", "O", "‚ÇÑ"]], pool: ["H", "S", "O", "N", "C", "P", "Cl", "F", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà"] },
                { question: "Á°´ÂåñÈäÖ„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Cu", "S"]], pool: ["Cu", "S", "Fe", "Zn", "Mg", "Ca", "Na", "K", "O", "Cl", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ"] },
                { question: "Á°´ÂåñÈâÑ„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Fe", "S"]], pool: ["Fe", "S", "Cu", "Zn", "Mg", "Ca", "Na", "K", "O", "Cl", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ"] },
                { question: "Ê∞¥Á¥†ÂàÜÂ≠ê„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["H", "‚ÇÇ"]], pool: ["H", "O", "N", "C", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà", "‚Çâ", "‚ÇÅ", "‚ÇÄ", "Cl", "S"] },
                { question: "ÁÇ≠ÈÖ∏„Ç´„É´„Ç∑„Ç¶„É†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Ca", "C", "O", "‚ÇÉ"]], pool: ["Ca", "C", "O", "H", "N", "S", "P", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà"] },
                { question: "ÁÇ≠ÈÖ∏„Éä„Éà„É™„Ç¶„É†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Na", "‚ÇÇ", "C", "O", "‚ÇÉ"]], pool: ["Na", "C", "O", "K", "Li", "H", "S", "P", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà"] },
                { question: "‰∫åÈÖ∏ÂåñÁÇ≠Á¥†„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["C", "O", "‚ÇÇ"]], pool: ["C", "O", "H", "N", "S", "P", "Cl", "F", "Br", "I", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÅ"] },
                { question: "Á™íÁ¥†ÂàÜÂ≠ê„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["N", "‚ÇÇ"]], pool: ["N", "H", "O", "C", "S", "P", "Cl", "F", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚Çá", "‚Çà"] }
            ],

            // ÂåñÂ≠¶ÂèçÂøúÂºè - „Éê„É©„É≥„Çπ„ÅÆÂèñ„Çå„ÅüÂèçÂøúÂºè
            reactions: [
                {
                    question: "Â°©ÂåñÈäÖÊ∞¥Ê∫∂Ê∂≤„ÅÆÈõªÊ∞óÂàÜËß£„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["Cu", "Cl", "‚ÇÇ", "‚Üí", "Cu", "+", "Cl", "‚ÇÇ"]],
                    pool: ["Cu", "Cl", "‚Üí", "+", "2", "3", "4", "5", "H", "O", "Na", "K", "Mg", "‚ÇÇ", "‚ÇÉ"]
                },
                {
                    question: "Â°©ÂåñÊ∞¥Á¥†ÔºàÂ°©ÈÖ∏Ôºâ„ÅÆÈõªÊ∞óÂàÜËß£„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "H", "Cl", "‚Üí", "H", "‚ÇÇ", "+", "Cl", "‚ÇÇ"]],
                    pool: ["H", "Cl", "‚Üí", "+", "2", "3", "4", "5", "O", "N", "C", "S", "Fe", "Cu", "‚ÇÇ"]
                },
                {
                    question: "ÈÖ∏ÂåñÈäÄ„ÅÆÁÜ±ÂàÜËß£„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "Ag", "‚ÇÇ", "O", "‚Üí", "4", "Ag", "+", "O", "‚ÇÇ"]],
                    pool: ["Ag", "O", "‚Üí", "+", "2", "3", "4", "5", "6", "Cu", "Fe", "Zn", "Na", "K", "‚ÇÇ"]
                },
                 {
                    question: "ÁÇ≠ÈÖ∏Ê∞¥Á¥†„Éä„Éà„É™„Ç¶„É†„ÅÆÁÜ±ÂàÜËß£„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "Na", "H", "C", "O", "‚ÇÉ", "‚Üí", "Na", "‚ÇÇ", "C", "O", "‚ÇÉ", "+", "C", "O", "‚ÇÇ", "+", "H", "‚ÇÇ", "O"]],
                    pool: ["Na", "H", "C", "O", "‚Üí", "+", "2", "3", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "‚ÇÇ", "‚ÇÉ"]
                },
                {
                    question: "Ê∞¥„ÅÆÈõªÊ∞óÂàÜËß£„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "H", "‚ÇÇ", "O", "‚Üí", "2", "H", "‚ÇÇ", "+", "O", "‚ÇÇ"]],
                    pool: ["H", "O", "‚Üí", "+", "2", "3", "4", "5", "6", "C", "N", "S", "Fe", "Cu", "‚ÇÇ"]
                },
                {
                    question: "Ê∞¥Á¥†„ÅÆÁáÉÁÑº„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "H", "‚ÇÇ", "+", "O", "‚ÇÇ", "‚Üí", "2", "H", "‚ÇÇ", "O"]],
                    pool: ["H", "O", "‚Üí", "+", "2", "3", "4", "5", "C", "N", "S", "Cl", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ"]
                },
                {
                    question: "ÁÇ≠Á¥†„ÅÆÁáÉÁÑºÔºàÂÆåÂÖ®ÁáÉÁÑºÔºâ„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["C", "+", "O", "‚ÇÇ", "‚Üí", "C", "O", "‚ÇÇ"]],
                    pool: ["C", "O", "H", "N", "S", "‚Üí", "+", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚ÇÜ", "Cl", "F", "P"]
                },
                {
                    question: "„Éû„Ç∞„Éç„Ç∑„Ç¶„É†„ÅÆÁáÉÁÑº„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "Mg", "+", "O", "‚ÇÇ", "‚Üí", "2", "Mg", "O"]],
                    pool: ["Mg", "O", "‚Üí", "+", "2", "3", "4", "5", "H", "C", "N", "S", "Fe", "Cu", "‚ÇÇ"]
                },
                {
                    question: "ÈâÑ„Å®Á°´ÈªÑ„ÅÆÂåñÂêàÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["Fe", "+", "S", "‚Üí", "Fe", "S"]],
                    pool: ["Fe", "S", "‚Üí", "+", "Cu", "O", "H", "N", "C", "Cl", "F", "Br", "I", "P", "Zn"]
                },
                 {
                    question: "ÈäÖ„Å®Á°´ÈªÑ„ÅÆÂåñÂêàÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["Cu", "+", "S", "‚Üí", "Cu", "S"]],
                    pool: ["Cu", "S", "‚Üí", "+", "Fe", "O", "H", "N", "C", "Cl", "F", "Br", "I", "P", "Zn"]
                },
                 {
                    question: "ÈäÖ„ÅÆÈÖ∏Âåñ„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "Cu", "+", "O", "‚ÇÇ", "‚Üí", "2", "Cu", "O"]],
                    pool: ["Cu", "O", "‚Üí", "+", "2", "3", "4", "5", "H", "C", "N", "S", "Fe", "Zn", "‚ÇÇ"]
                },
                 {
                    question: "ÁÇ≠Á¥†„Å´„Çà„ÇãÈÖ∏ÂåñÈäÖ„ÅÆÈÇÑÂÖÉ„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["2", "Cu", "O", "+", "C", "‚Üí", "2", "Cu", "+", "C", "O", "‚ÇÇ"]],
                    pool: ["Cu", "O", "C", "‚Üí", "+", "2", "3", "4", "5", "H", "S", "Fe", "Zn", "‚ÇÇ"]
                },
                 {
                    question: "Ê∞¥Á¥†„Å´„Çà„ÇãÈÖ∏ÂåñÈäÖ„ÅÆÈÇÑÂÖÉ„ÅÆÂåñÂ≠¶ÂèçÂøúÂºè„ÅØÔºü",
                    answer: [["Cu", "O", "+", "H", "‚ÇÇ", "‚Üí", "Cu", "+", "H", "‚ÇÇ", "O"]],
                    pool: ["Cu", "O", "H", "‚Üí", "+", "2", "3", "4", "5", "C", "S", "Fe", "Zn", "‚ÇÇ"]
                }
            ],

            // „Ç§„Ç™„É≥ - Ê≠£Á¢∫„Å™„Ç§„Ç™„É≥Âºè
            ions: [
                 { question: "Ê∞¥Á¥†„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["H", "‚Å∫"]], pool: ["H", "O", "N", "C", "Li", "Na", "K", "Mg", "Ca", "‚Å∫", "¬≤‚Å∫", "‚Åª", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª"] },
                 { question: "„Ç´„É™„Ç¶„É†„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["K", "‚Å∫"]], pool: ["K", "Na", "Li", "Rb", "Cs", "Mg", "Ca", "Fe", "Cu", "‚Å∫", "¬≤‚Å∫", "‚Åª", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "H"] },
                 { question: "„Éä„Éà„É™„Ç¶„É†„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Na", "‚Å∫"]], pool: ["Na", "K", "Li", "Mg", "Ca", "Fe", "Cu", "Zn", "‚Å∫", "¬≤‚Å∫", "‚Åª", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "H"] },
                 { question: "ÈäÄ„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Ag", "‚Å∫"]], pool: ["Ag", "Cu", "Au", "Na", "K", "Mg", "Ca", "Fe", "Zn", "‚Å∫", "¬≤‚Å∫", "‚Åª", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "Cl"] },
                 { question: "„Ç¢„É≥„É¢„Éã„Ç¶„É†„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["N", "H", "‚ÇÑ", "‚Å∫"]], pool: ["N", "H", "O", "C", "S", "P", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª"] },
                 { question: "„Éû„Ç∞„Éç„Ç∑„Ç¶„É†„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Mg", "¬≤‚Å∫"]], pool: ["Mg", "Ca", "Sr", "Ba", "Na", "K", "Fe", "Cu", "¬≤‚Å∫", "‚Å∫", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "‚Åª", "H"] },
                 { question: "„Ç´„É´„Ç∑„Ç¶„É†„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Ca", "¬≤‚Å∫"]], pool: ["Ca", "Mg", "Sr", "Ba", "Na", "K", "Fe", "Cu", "¬≤‚Å∫", "‚Å∫", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "‚Åª", "H"] },
                 { question: "„Éê„É™„Ç¶„É†„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Ba", "¬≤‚Å∫"]], pool: ["Ba", "Ca", "Mg", "Sr", "Na", "K", "Fe", "Cu", "¬≤‚Å∫", "‚Å∫", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "‚Åª"] },
                 { question: "‰∫úÈâõ„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Zn", "¬≤‚Å∫"]], pool: ["Zn", "Cu", "Fe", "Ni", "Co", "Mg", "Ca", "Na", "K", "¬≤‚Å∫", "‚Å∫", "‚Åª", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "S"] },
                 { question: "ÈäÖ„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Cu", "¬≤‚Å∫"]], pool: ["Cu", "Fe", "Ag", "Au", "Zn", "Ni", "Co", "Mn", "Cr", "¬≤‚Å∫", "‚Å∫", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "‚Åª"] },
                 { question: "ÈâÑ„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Fe", "¬≤‚Å∫"]], pool: ["Fe", "Cu", "Zn", "Ni", "Co", "Mg", "Ca", "Na", "K", "¬≤‚Å∫", "‚Å∫", "‚Åª", "¬≤‚Åª", "¬≥‚Å∫", "¬≥‚Åª", "S"] },
                 { question: "Ê∞¥ÈÖ∏ÂåñÁâ©„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["O", "H", "‚Åª"]], pool: ["O", "H", "Cl", "Br", "F", "I", "N", "S", "P", "‚Åª", "‚Å∫", "¬≤‚Åª", "¬≤‚Å∫", "¬≥‚Åª", "¬≥‚Å∫", "Na"] },
                 { question: "Â°©ÂåñÁâ©„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["Cl", "‚Åª"]], pool: ["Cl", "Br", "I", "F", "O", "S", "N", "P", "‚Åª", "‚Å∫", "¬≤‚Åª", "¬≤‚Å∫", "¬≥‚Åª", "¬≥‚Å∫", "H"] },
                 { question: "Á°ùÈÖ∏„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["N", "O", "‚ÇÉ", "‚Åª"]], pool: ["N", "O", "S", "P", "C", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "‚Åª", "‚Å∫", "¬≤‚Åª", "¬≤‚Å∫", "¬≥‚Åª", "¬≥‚Å∫", "H"] },
                 { question: "Á°´ÈÖ∏„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["S", "O", "‚ÇÑ", "¬≤‚Åª"]], pool: ["S", "O", "N", "C", "P", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "¬≤‚Åª", "‚Åª", "‚Å∫", "¬≤‚Å∫", "¬≥‚Åª", "¬≥‚Å∫", "H"] },
                 { question: "ÁÇ≠ÈÖ∏„Ç§„Ç™„É≥„ÅÆÂåñÂ≠¶Âºè„ÅØÔºü", answer: [["C", "O", "‚ÇÉ", "¬≤‚Åª"]], pool: ["C", "O", "N", "S", "P", "‚ÇÇ", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "¬≤‚Åª", "‚Åª", "‚Å∫", "¬≤‚Å∫", "¬≥‚Åª", "¬≥‚Å∫", "Ca"] }
            ],

// „Ç§„Ç™„É≥ÂèçÂøúÂºè - Ë§áÊï∞Ê≠£Ëß£„Éë„Çø„Éº„É≥ÂØæÂøú
ionicReactions: [
    {
        question: "Â°©Âåñ„Éä„Éà„É™„Ç¶„É†„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        // 2„Å§„ÅÆÊ≠£Ëß£„Éë„Çø„Éº„É≥„Å´ÂØæÂøú
        answer: [
            ["Na", "Cl", "‚Üí", "Na", "‚Å∫", "+", "Cl", "‚Åª"]  // „Éë„Çø„Éº„É≥1: ÂàÜËß£Ë°®Ë®ò
        ],
        pool: ["Na", "Cl", "‚Üí", "+", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "H", "O", "K", "Mg", "Ca"]
    },
    {
        question: "Â°©ÂåñÊ∞¥Á¥†„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["H", "Cl", "‚Üí", "H", "‚Å∫", "+", "Cl", "‚Åª"]    // „Éë„Çø„Éº„É≥1: ÂàÜËß£Ë°®Ë®ò
        ],
        pool: ["H", "Cl", "‚Üí", "+", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "O", "N", "C", "S", "Na", "K"]
    },
    {
        question: "Á°´ÈÖ∏„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["H", "‚ÇÇ", "S", "O", "‚ÇÑ", "‚Üí", "2", "H", "‚Å∫", "+", "S", "O", "‚ÇÑ", "¬≤‚Åª"]
        ],
        pool: ["H", "‚ÇÇ", "S", "O", "‚ÇÑ", "‚Üí", "+", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "2", "3", "4"]
    },
    {
        question: "Á°ùÈÖ∏„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["H", "N", "O", "‚ÇÉ", "‚Üí", "H", "‚Å∫", "+", "N", "O", "‚ÇÉ", "‚Åª"]  // „Éë„Çø„Éº„É≥1: ÂàÜËß£Ë°®Ë®ò
        ],
        pool: ["H", "N", "O", "‚ÇÉ", "‚Üí", "+", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "S", "C", "P", "‚ÇÇ"]
    },
    {
        question: "ÁÇ≠ÈÖ∏„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["H", "‚ÇÇ", "C", "O", "‚ÇÉ", "‚Üí", "2", "H", "‚Å∫", "+", "C", "O", "‚ÇÉ", "¬≤‚Åª"]
        ],
        pool: ["H", "‚ÇÇ", "C", "O", "‚ÇÉ", "‚Üí", "+", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "2", "3", "4", "S", "N"]
    },
    {
        question: "Ê∞¥ÈÖ∏Âåñ„Éä„Éà„É™„Ç¶„É†„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["Na", "O", "H", "‚Üí", "Na", "‚Å∫", "+", "O", "H", "‚Åª"]  // „Éë„Çø„Éº„É≥1: ÂàÜËß£Ë°®Ë®ò
        ],
        pool: ["Na", "O", "H", "‚Üí", "+", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "K", "Mg", "Ca"]
    },
    {
        question: "Ê∞¥ÈÖ∏Âåñ„Ç´„É´„Ç∑„Ç¶„É†„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["Ca", "(", "O", "H", ")", "‚ÇÇ", "‚Üí", "Ca", "¬≤‚Å∫", "+", "2", "O", "H", "‚Åª"]
        ],
        pool: ["Ca", "(", "O", "H", ")", "‚ÇÇ", "‚Üí", "+", "¬≤‚Å∫", "‚Åª", "‚Å∫", "¬≤‚Åª", "2", "3", "4", "Mg", "Ba"]
    },
    {
        question: "Ê∞¥ÈÖ∏Âåñ„Éê„É™„Ç¶„É†„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["Ba", "(", "O", "H", ")", "‚ÇÇ", "‚Üí", "Ba", "¬≤‚Å∫", "+", "2", "O", "H", "‚Åª"]
        ],
        pool: ["Ba", "(", "O", "H", ")", "‚ÇÇ", "‚Üí", "+", "¬≤‚Å∫", "‚Åª", "‚Å∫", "¬≤‚Åª", "2", "3", "4", "Ca", "Mg"]
    },
    {
        question: "„Ç¢„É≥„É¢„Éã„Ç¢„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["N", "H", "‚ÇÉ", "+", "H", "‚ÇÇ", "O", "‚Üí", "N", "H", "‚ÇÑ", "‚Å∫", "+", "O", "H", "‚Åª"]
        ],
        pool: ["N", "H", "‚ÇÉ", "‚ÇÇ", "‚ÇÑ", "O", "+", "‚Üí", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "C", "P"]
    },
    {
        question: "Â°©ÂåñÈäÖ„ÅÆÈõªÈõ¢„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [
            ["Cu", "Cl", "‚ÇÇ", "‚Üí", "Cu", "¬≤‚Å∫", "+", "2", "Cl", "‚Åª"]  // „Éë„Çø„Éº„É≥1: ÂàÜËß£Ë°®Ë®ò
        ],
        pool: ["Cu", "Cl", "‚ÇÇ", "‚Üí", "+", "¬≤‚Å∫", "‚Åª", "‚Å∫", "¬≤‚Åª", "3", "4", "5", "H", "O"]
    },
    {
        question: "‰∏≠ÂíåÂèçÂøú„ÅÆÊ≠£Âë≥„Ç§„Ç™„É≥ÂèçÂøúÂºè„ÅØÔºü",
        answer: [["H", "‚Å∫", "+", "O", "H", "‚Åª", "‚Üí", "H", "‚ÇÇ", "O"]],
        pool: ["H", "O", "H", "Na", "Cl", "K", "Ca", "Mg", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "‚Üí", "+", "‚ÇÇ", "‚ÇÉ"]
    },
    {
        question: "Á°´ÈÖ∏„Å®Ê∞¥ÈÖ∏Âåñ„Éê„É™„Ç¶„É†„ÅÆ‰∏≠Âíå„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [["H", "‚ÇÇ", "S", "O", "‚ÇÑ", "+", "Ba", "(", "O", "H", ")", "‚ÇÇ", "‚Üí", "Ba", "S", "O", "‚ÇÑ", "+", "2", "H", "‚ÇÇ", "O"]],
        pool: ["H", "S", "O", "Ba", "‚Üí", "+", "2", "‚ÇÉ", "‚ÇÑ", "‚ÇÖ", "(", ")"]
    },
    {
        question: "ÈäÄ„Ç§„Ç™„É≥„Å®Â°©ÂåñÁâ©„Ç§„Ç™„É≥„ÅÆÊ≤àÊÆøÂèçÂøúÂºè„ÅØÔºü",
        answer: [["Ag", "‚Å∫", "+", "Cl", "‚Åª", "‚Üí", "Ag", "Cl"]],
        pool: ["Ag", "Cl", "Na", "K", "Cu", "Fe", "‚Å∫", "‚Åª", "¬≤‚Å∫", "¬≤‚Åª", "‚Üí", "+", "‚ÇÇ", "‚ÇÉ"]
    },
    {
        question: "ÁÇ≠ÈÖ∏„Ç§„Ç™„É≥„Å®Ê∞¥Á¥†„Ç§„Ç™„É≥„ÅÆÂèçÂøúÂºè„ÅØÔºü",
        answer: [["C", "O", "‚ÇÉ", "¬≤‚Åª", "+", "2", "H", "‚Å∫", "‚Üí", "H", "‚ÇÇ", "O", "+", "C", "O", "‚ÇÇ"]],
        pool: ["C", "O", "H", "‚ÇÉ", "‚ÇÇ", "¬≤‚Åª", "‚Å∫", "‚Üí", "+", "2", "3", "4", "5", "Na", "Cl"]
    }
]
        };

        // ÂÖ®ÁØÑÂõ≤„É¢„Éº„Éâ„ÅÆÂïèÈ°å„ÇíÂãïÁöÑ„Å´ÁîüÊàê
        function generateMixedProblems() {
            const allProblems = [];
            Object.keys(gameData).forEach(mode => {
                if (mode !== 'mixed') {
                    allProblems.push(...gameData[mode]);
                }
            });
            return shuffleArray(allProblems);
        }

        // „Ç≤„Éº„É†Áä∂ÊÖã
        let currentMode = '';
        let currentProblem = null;
        let currentProblemIndex = 0;
        let correctCount = 0;
        let totalCount = 0;
        let comboCount = 0;
        let currentAnswer = [];
        let isCorrectAnswerShowing = false;
        let hasCheckedCurrentProblem = false;
        let isAnswerButtonUsed = false;

        // „É©„É≥„ÉÄ„É†Âá∫È°åÁî®„ÅÆÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†
        let availableProblems = {};
        let usedProblems = {};

        // „Éâ„É©„ÉÉ„Ç∞Áä∂ÊÖã
        let isDragging = false;
        let dragElement = null;
        let dragOffset = { x: 0, y: 0 };
        let dragStartTime = 0;
        let hasMoved = false;
        let startPosition = { x: 0, y: 0 };
        let interactionInProgress = false;
        let dragThreshold = 10;

        // Èü≥Èüø„Ç∑„Çπ„ÉÜ„É†
        class KawaiiSoundSystem {
            constructor() {
                this.audioContext = null;
                this.initAudio();
            }

            initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.log('Èü≥Â£∞„Ç∑„Çπ„ÉÜ„É†„ÇíÂàùÊúüÂåñ„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü');
                }
            }

            playTone(frequency, duration, type = 'sine', volume = 0.3) {
                if (!this.audioContext) return;

                try {
                    if (this.audioContext.state === 'suspended') {
                        this.audioContext.resume();
                    }

                    const oscillator = this.audioContext.createOscillator();
                    const gainNode = this.audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(this.audioContext.destination);

                    oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                    oscillator.type = type;

                    gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(volume, this.audioContext.currentTime + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);

                    oscillator.start(this.audioContext.currentTime);
                    oscillator.stop(this.audioContext.currentTime + duration);
                } catch (e) {
                    // „Ç®„É©„Éº„ÅØÁÑ°Ë¶ñ
                }
            }

            playClick() {
                this.playTone(800, 0.15, 'sine', 0.2);
            }

            playCorrect() {
                const notes = [523, 659, 784, 1047];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.playTone(freq, 0.2, 'sine', 0.25), i * 100);
                });
            }

            playIncorrect() {
                this.playTone(300, 0.5, 'sawtooth', 0.2);
            }

            playMagical() {
                const notes = [1047, 1175, 1319, 1568, 1760];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.playTone(freq, 0.3, 'sine', 0.2), i * 80);
                });
            }

            playVictory() {
                const victoryNotes = [523, 659, 784, 1047, 1319, 1568];
                victoryNotes.forEach((freq, i) => {
                    setTimeout(() => this.playTone(freq, 0.3, 'sine', 0.3), i * 150);
                });
                
                setTimeout(() => {
                    for (let i = 0; i < 8; i++) {
                        setTimeout(() => {
                            this.playTone(2093 + Math.random() * 500, 0.2, 'sine', 0.2);
                        }, i * 100);
                    }
                }, 900);
            }

            playTransform() {
                this.playTone(440, 0.1, 'square', 0.15);
                setTimeout(() => this.playTone(880, 0.1, 'square', 0.15), 100);
                setTimeout(() => this.playTone(1320, 0.1, 'square', 0.15), 200);
            }

            vibrate(pattern) {
                if ('vibrate' in navigator) {
                    navigator.vibrate(pattern);
                }
            }
        }

        const soundSystem = new KawaiiSoundSystem();

        // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´„Ç∑„Çπ„ÉÜ„É†
        class KawaiiParticleSystem {
            constructor() {
                this.particles = [];
            }

            createParticle(x, y, emoji, color = null) {
                const particle = document.createElement('div');
                particle.className = 'kawaii-particle';
                particle.textContent = emoji;
                if (color) particle.style.color = color;
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                document.body.appendChild(particle);

                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 2000);
            }

            createExplosion(x, y, emojis, count = 8) {
                for (let i = 0; i < count; i++) {
                    setTimeout(() => {
                        const emoji = emojis[Math.floor(Math.random() * emojis.length)];
                        const offsetX = (Math.random() - 0.5) * 60;
                        const offsetY = (Math.random() - 0.5) * 60;
                        this.createParticle(x + offsetX, y + offsetY, emoji);
                    }, i * 50);
                }
            }
        }

        const particleSystem = new KawaiiParticleSystem();

        // „Éâ„É©„ÉÉ„Ç∞„Éª„Çø„ÉÉ„ÉóÊ©üËÉΩ
        function setupDragEvents(card, atom) {
            card.addEventListener('mousedown', (e) => {
                e.preventDefault();
                startInteraction(e, card, atom);
            });
            
            card.addEventListener('touchstart', (e) => {
                e.preventDefault();
                startInteraction(e.touches[0], card, atom);
            }, { passive: false });
        }

        function startInteraction(e, card, atom) {
            if (interactionInProgress) return;

            dragStartTime = Date.now();
            hasMoved = false;
            isDragging = false;
            startPosition = { x: e.clientX, y: e.clientY };
            
            const rect = card.getBoundingClientRect();
            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;
            
            dragElement = card;
            
            const onMove = (moveEvent) => onInteractionMove(moveEvent, card, atom);
            const onEnd = (endEvent) => onInteractionEnd(endEvent, atom, card);
            
            const mouseMoveHandler = (e) => onMove(e);
            const mouseUpHandler = (e) => onEnd(e);
            
            const touchMoveHandler = (e) => {
                e.preventDefault();
                onMove(e.touches[0]);
            };
            const touchEndHandler = (e) => onEnd(e.changedTouches[0]);
            
            document.addEventListener('mousemove', mouseMoveHandler);
            document.addEventListener('mouseup', mouseUpHandler);
            document.addEventListener('touchmove', touchMoveHandler, { passive: false });
            document.addEventListener('touchend', touchEndHandler);
            
            card._removeListeners = () => {
                document.removeEventListener('mousemove', mouseMoveHandler);
                document.removeEventListener('mouseup', mouseUpHandler);
                document.removeEventListener('touchmove', touchMoveHandler);
                document.removeEventListener('touchend', touchEndHandler);
            };
        }

        function onInteractionMove(e, card, atom) {
            if (!dragElement) return;
            
            const currentPos = { x: e.clientX, y: e.clientY };
            const distance = Math.sqrt(
                Math.pow(currentPos.x - startPosition.x, 2) + 
                Math.pow(currentPos.y - startPosition.y, 2)
            );
            
            if (distance > dragThreshold && !isDragging) {
                isDragging = true;
                hasMoved = true;
                dragElement.classList.add('dragging');
            }
            
            if (isDragging) {
                const cardsSection = document.getElementById('cardsSection');
                const rect = cardsSection.getBoundingClientRect();
                
                let x = e.clientX - rect.left - dragOffset.x;
                let y = e.clientY - rect.top - dragOffset.y;
                
                x = Math.max(0, Math.min(x, rect.width - dragElement.offsetWidth));
                y = Math.max(0, Math.min(y, rect.height - dragElement.offsetHeight));
                
                dragElement.style.left = x + 'px';
                dragElement.style.top = y + 'px';
            }
        }

        function onInteractionEnd(e, atom, card) {
            const interactionTime = Date.now() - dragStartTime;
            
            if (dragElement) {
                dragElement.classList.remove('dragging');
            }
            
            if (card._removeListeners) {
                card._removeListeners();
                delete card._removeListeners;
            }
            
            if (!isDragging && !hasMoved && interactionTime < 500 && !interactionInProgress) {
                interactionInProgress = true;
                selectAtomCard(atom, card);
                setTimeout(() => {
                    interactionInProgress = false;
                }, 100);
            }
            
            isDragging = false;
            dragElement = null;
            hasMoved = false;
        }

        // „É©„É≥„ÉÄ„É†Âá∫È°å„Ç∑„Çπ„ÉÜ„É†„ÅÆÂàùÊúüÂåñ
        function initRandomSystem(mode) {
            if (!gameData[mode]) return;
            
            // Âà©Áî®ÂèØËÉΩ„Å™ÂïèÈ°å„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÇíÁîüÊàê
            availableProblems[mode] = Array.from(
                { length: gameData[mode].length }, 
                (_, i) => i
            );
            
            // ‰ΩøÁî®Ê∏à„ÅøÂïèÈ°å„Çí„É™„Çª„ÉÉ„Éà
            usedProblems[mode] = [];
            
            // Âà©Áî®ÂèØËÉΩ„Å™ÂïèÈ°å„Çí„Ç∑„É£„ÉÉ„Éï„É´
            availableProblems[mode] = shuffleArray(availableProblems[mode]);
        }

        // „É©„É≥„ÉÄ„É†„Å´Ê¨°„ÅÆÂïèÈ°å„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÇíÂèñÂæó
        function getRandomProblemIndex(mode) {
            if (!availableProblems[mode] || availableProblems[mode].length === 0) {
                // ÂÖ®ÂïèÈ°å„ÇíÂá∫È°å„ÅóÁµÇ„Çè„Å£„Åü„Çâ„É™„Çª„ÉÉ„Éà
                initRandomSystem(mode);
            }
            
            // Âà©Áî®ÂèØËÉΩ„Å™ÂïèÈ°å„Åã„Çâ‰∏Ä„Å§„ÇíÂèñÂæó
            const randomIndex = availableProblems[mode].pop();
            usedProblems[mode].push(randomIndex);
            
            return randomIndex;
        }

        // „Ç≤„Éº„É†ÂàùÊúüÂåñ
        function initGame() {
            setupEventListeners();
            setTimeout(() => {
                selectMode('elements');
            }, 100);
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆöÔºàÊ≠£Ëß£Ë°®Á§∫„ÅÆÊ∞∏Á∂öÂåñÂØæÂøúÔºâ
        function setupEventListeners() {
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const mode = e.target.dataset.mode || e.target.closest('.mode-btn').dataset.mode;
                    selectMode(mode);
                });
            });

            document.getElementById('checkBtn').addEventListener('click', checkAnswer);
            
            // „ÇØ„É™„Ç¢„Éú„Çø„É≥„ÅßÊ≠£Ëß£Ë°®Á§∫„ÇÇ„ÇØ„É™„Ç¢
            document.getElementById('clearBtn').addEventListener('click', () => {
                clearAnswer();
                if (isCorrectAnswerShowing || isAnswerButtonUsed) {
                    isCorrectAnswerShowing = false;
                    isAnswerButtonUsed = false;
                    updateAnswerDisplay();
                }
            });
            
            document.getElementById('hintBtn').addEventListener('click', showHint);
            document.getElementById('answerBtn').addEventListener('click', showCorrectAnswer);
            
            // Ê¨°„Å∏„Éú„Çø„É≥„ÅßÊ≠£Ëß£Ë°®Á§∫„ÇÇ„ÇØ„É™„Ç¢
            document.getElementById('nextBtn').addEventListener('click', () => {
                if (isCorrectAnswerShowing || isAnswerButtonUsed) {
                    isCorrectAnswerShowing = false;
                    isAnswerButtonUsed = false;
                }
                nextProblem();
            });

            document.getElementById('gameTitle').addEventListener('click', () => {
                soundSystem.playMagical();
                soundSystem.vibrate([100, 50, 100, 50, 150]);
                
                const rect = document.getElementById('gameTitle').getBoundingClientRect();
                particleSystem.createExplosion(
                    rect.left + rect.width / 2,
                    rect.top + rect.height / 2,
                    ['üß™', '‚öóÔ∏è', 'üî¨', 'üíï', '‚ú®', 'üåü'],
                    6
                );
            });

            document.addEventListener('click', () => {
                if (soundSystem.audioContext && soundSystem.audioContext.state === 'suspended') {
                    soundSystem.audioContext.resume();
                }
            }, { once: true });
        }

        // „É¢„Éº„ÉâÈÅ∏ÊäûÔºàÊ≠£Ëß£Ë°®Á§∫„Çí„ÇØ„É™„Ç¢Ôºâ
        function selectMode(mode) {
            if (mode === 'mixed') {
                gameData.mixed = generateMixedProblems();
            }
            
            if (!gameData[mode] || gameData[mode].length === 0) return;
            
            currentMode = mode;
            
            // „É©„É≥„ÉÄ„É†Âá∫È°å„Ç∑„Çπ„ÉÜ„É†„ÇíÂàùÊúüÂåñ
            initRandomSystem(mode);
            
            // Ê≠£Ëß£Ë°®Á§∫Áä∂ÊÖã„Çí„ÇØ„É™„Ç¢
            if (isCorrectAnswerShowing || isAnswerButtonUsed) {
                isCorrectAnswerShowing = false;
                isAnswerButtonUsed = false;
            }
            
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const selectedBtn = document.querySelector(`[data-mode="${mode}"]`);
            if (selectedBtn) {
                selectedBtn.classList.add('active');
            }

            soundSystem.playMagical();
            soundSystem.vibrate([100, 50, 100]);

            loadProblem();

            if (selectedBtn) {
                const rect = selectedBtn.getBoundingClientRect();
                particleSystem.createExplosion(
                    rect.left + rect.width / 2,
                    rect.top + rect.height / 2,
                    ['üéâ', '‚ú®', 'üíï', 'üåü'],
                    4
                );
            }
        }

        // ÂïèÈ°åË™≠„ÅøËæº„ÅøÔºà„É©„É≥„ÉÄ„É†Âá∫È°åÂØæÂøúÔºâ
        function loadProblem() {
            if (!currentMode || !gameData[currentMode]) return;

            const problems = gameData[currentMode];
            
            // Ê∑∑Âêà„É¢„Éº„Éâ„ÅÆÂ†¥Âêà„ÅØÈ†ÜÁï™„Å´„ÄÅ„Åù„Çå‰ª•Â§ñ„ÅØ„É©„É≥„ÉÄ„É†„Å´ÈÅ∏Êäû
            if (currentMode === 'mixed') {
                if (currentProblemIndex >= problems.length) {
                    gameData.mixed = generateMixedProblems();
                    currentProblemIndex = 0;
                }
                currentProblem = problems[currentProblemIndex];
                currentProblemIndex++;
            } else {
                // „É©„É≥„ÉÄ„É†„Å´ÂïèÈ°å„ÇíÈÅ∏Êäû
                currentProblemIndex = getRandomProblemIndex(currentMode);
                currentProblem = problems[currentProblemIndex];
            }

            isCorrectAnswerShowing = false;
            isAnswerButtonUsed = false;
            hasCheckedCurrentProblem = false;
            
            clearAnswer();
            
            setTimeout(() => {
                createAtomCards();
            }, 100);
            
            document.getElementById('questionInAnswer').textContent = currentProblem.question;
        }

        // ÂéüÂ≠ê„Ç´„Éº„Éâ‰ΩúÊàêÔºàÂÆâÂÆö„Åó„ÅüËÉåÊôØËâ≤„Ç∑„Çπ„ÉÜ„É†Ôºâ
        function createAtomCards() {
            const cardsSection = document.getElementById('cardsSection');
            cardsSection.innerHTML = '';

            if (!currentProblem) return;

            // Ë§áÊï∞„Éë„Çø„Éº„É≥„ÅÆÊ≠£Ëß£„Åã„ÇâÊúÄÂàù„ÅÆ„Éë„Çø„Éº„É≥„Çí‰ΩøÁî®„Åó„Å¶„Ç´„Éº„ÉâÁîüÊàê
            let selectedAtoms = [...currentProblem.answer[0]];
            
            const uniquePool = currentProblem.pool.filter(atom => !selectedAtoms.includes(atom));
            const targetCount = 18;
            const additionalCount = Math.min(targetCount - selectedAtoms.length, uniquePool.length);
            
            const shuffledPool = shuffleArray(uniquePool);
            selectedAtoms = [...selectedAtoms, ...shuffledPool.slice(0, additionalCount)];
            
            const finalAtoms = shuffleArray(selectedAtoms);

            const cardsSection_rect = cardsSection.getBoundingClientRect();
            const cardSize = 60;
            const margin = 10;

            finalAtoms.forEach((atom, index) => {
                const card = document.createElement('div');
                card.className = `atom-card ${getAtomClass(atom)}`;
                
                if (isSpecialSymbol(atom)) {
                    card.classList.add('symbol-large');
                }
                
                card.textContent = atom;

                let x, y;
                let attempts = 0;
                let validPosition = false;

                while (!validPosition && attempts < 50) {
                    x = Math.random() * (cardsSection_rect.width - cardSize - margin * 2) + margin;
                    y = Math.random() * (cardsSection_rect.height - cardSize - margin * 2) + margin;

                    validPosition = true;
                    const existingCards = cardsSection.children;
                    for (let i = 0; i < existingCards.length; i++) {
                        const existingCard = existingCards[i];
                        const existingX = parseFloat(existingCard.style.left);
                        const existingY = parseFloat(existingCard.style.top);
                        const distance = Math.sqrt(Math.pow(x - existingX, 2) + Math.pow(y - existingY, 2));
                        if (distance < cardSize * 0.7) {
                            validPosition = false;
                            break;
                        }
                    }
                    attempts++;
                }

                if (!validPosition) {
                    x = Math.random() * (cardsSection_rect.width - cardSize - margin * 2) + margin;
                    y = Math.random() * (cardsSection_rect.height - cardSize - margin * 2) + margin;
                }

                card.style.left = x + 'px';
                card.style.top = y + 'px';

                setupDragEvents(card, atom);

                card.classList.add('spawn-animation');
                setTimeout(() => {
                    card.classList.remove('spawn-animation');
                    card.classList.add('floating');
                }, 400 + index * 25);

                cardsSection.appendChild(card);
            });
        }

        // ÁâπÊÆäË®òÂè∑Âà§ÂÆöÔºàÂ§ß„Åç„ÅèË°®Á§∫„Åô„Åπ„ÅçË®òÂè∑Ôºâ
        function isSpecialSymbol(atom) {
            const specialSymbols = ['+', '‚Üí', '‚Å∫', '‚Åª', '¬≤‚Å∫', '¬≤‚Åª', '¬≥‚Å∫', '¬≥‚Åª', '‚ÇÅ', '‚ÇÇ', '‚ÇÉ', '‚ÇÑ', '‚ÇÖ', '‚ÇÜ', '‚Çá', '‚Çà', '‚Çâ', '‚ÇÄ'];
            return specialSymbols.includes(atom);
        }

        // ÈÖçÂàó„Çí„Ç∑„É£„ÉÉ„Éï„É´
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // ÂéüÂ≠ê„Ç´„Éº„ÉâÈÅ∏Êäû
        function selectAtomCard(atom, cardElement) {
            if (isCorrectAnswerShowing || isAnswerButtonUsed) return;
            
            cardElement.classList.add('selected');
            setTimeout(() => {
                cardElement.classList.remove('selected');
            }, 600);

            addToAnswer(atom);

            soundSystem.playClick();
            soundSystem.vibrate([50]);

            const rect = cardElement.getBoundingClientRect();
            particleSystem.createParticle(
                rect.left + rect.width / 2,
                rect.top + rect.height / 2,
                '‚ú®'
            );
        }

        // ÂéüÂ≠ê„ÇØ„É©„ÇπÂèñÂæóÔºàÁ¢∫ÂÆü„Å™ËÉåÊôØËâ≤„Ç∑„Çπ„ÉÜ„É†Ôºâ
        function getAtomClass(atom) {
            if (['H'].includes(atom)) return 'atom-hydrogen';
            if (['O'].includes(atom)) return 'atom-oxygen';
            if (['C'].includes(atom)) return 'atom-carbon';
            if (['N'].includes(atom)) return 'atom-nitrogen';
            if (['Cl', 'Br', 'I', 'F'].includes(atom)) return 'atom-chlorine';
            if (['S', 'P'].includes(atom)) return 'atom-sulfur';
            if (['Fe', 'Cu', 'Na', 'Mg', 'Ba', 'Ag', 'K', 'Ca', 'Zn', 'Al', 'Ti', 'Mn', 'Ni', 'Co', 'Cr', 'V', 'Sc', 'Sr', 'Ra', 'Be', 'Li', 'Rb', 'Cs', 'Fr', 'Pb'].includes(atom)) return 'atom-metal';
            if (['1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '‚ÇÅ', '‚ÇÇ', '‚ÇÉ', '‚ÇÑ', '‚ÇÖ', '‚ÇÜ', '‚Çá', '‚Çà', '‚Çâ', '‚ÇÄ'].includes(atom)) return 'atom-number';
            if (['‚Å∫', '‚Åª', '¬≤‚Å∫', '¬≤‚Åª', '¬≥‚Å∫', '¬≥‚Åª', 'e'].includes(atom)) return 'atom-ion';
            if (['‚Üí', '+', '(', ')'].includes(atom)) return 'atom-special';
            return 'atom-carbon';
        }

        // ÂõûÁ≠î„Å´ËøΩÂä†
        function addToAnswer(atom) {
            currentAnswer.push(atom);
            updateAnswerDisplay();
        }

        // ÂõûÁ≠îË°®Á§∫Êõ¥Êñ∞ÔºàÊ≠£Ëß£Ë°®Á§∫„ÅÆÊ∞∏Á∂öÂåñÂØæÂøúÔºâ
        function updateAnswerDisplay() {
            const answerContent = document.getElementById('answerContent');
            
            if (isCorrectAnswerShowing || isAnswerButtonUsed) {
                // Ê≠£Ëß£Ë°®Á§∫‰∏≠„ÅØË°®Á§∫„Çí„Åù„ÅÆ„Åæ„ÅæÁ∂≠ÊåÅ
                return;
            }
            
            if (currentAnswer.length === 0) {
                answerContent.innerHTML = '<div style="color: var(--light-purple); font-size: 0.9em;">„Ç´„Éº„Éâ„Çí„Çø„ÉÉ„Éó„Åó„Å¶ÂåñÂ≠¶Âºè„Çí‰Ωú„Çç„ÅÜ ‚ú®</div>';
                document.getElementById('answerArea').classList.remove('has-answer');
                document.getElementById('answerArea').classList.remove('correct-state');
            } else {
                answerContent.innerHTML = currentAnswer.map((atom, index) => 
                    `<span class="answer-piece" onclick="removeFromAnswer(${index})">${atom}</span>`
                ).join('');
                document.getElementById('answerArea').classList.add('has-answer');
            }
        }

        // Ê≠£Ëß£ÊôÇ„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Âá¶ÁêÜ
        function animateCorrectAnswer() {
            const answerPieces = document.querySelectorAll('.answer-piece');
            const answerContent = document.getElementById('answerContent');
            const answerArea = document.getElementById('answerArea');
            
            answerArea.classList.add('correct-state');
            isCorrectAnswerShowing = true;
            
            answerPieces.forEach((piece, index) => {
                setTimeout(() => {
                    soundSystem.playTransform();
                    
                    piece.classList.add('transforming');
                    
                    if (index === answerPieces.length - 1) {
                        setTimeout(() => {
                            showFinalCorrectAnswer();
                        }, 800);
                    }
                }, index * 200);
            });
        }

        // ÊúÄÁµÇÁöÑ„Å™Ê≠£Ëß£Ë°®Á§∫ÔºàÂÆåÂÖ®Ê∞∏Á∂öË°®Á§∫Ôºâ
        function showFinalCorrectAnswer() {
            const answerContent = document.getElementById('answerContent');
            const correctAnswerText = currentProblem.answer[0].join('');
            
            soundSystem.playVictory();
            soundSystem.vibrate([100, 50, 100, 50, 200, 50, 300]);
            
            // ÂÆåÂÖ®Ê∞∏Á∂öË°®Á§∫Ôºà„É¶„Éº„Ç∂„Éº„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥„Åæ„ÅßË°®Á§∫„ÅóÁ∂ö„Åë„ÇãÔºâ
            answerContent.innerHTML = `
                <div class="correct-answer-display">
                    <span>üéâ</span>
                    <span>Ê≠£Ëß£: ${correctAnswerText}</span>
                    <span>üéâ</span>
                </div>
            `;
            
            const rect = answerContent.getBoundingClientRect();
            particleSystem.createExplosion(
                rect.left + rect.width / 2,
                rect.top + rect.height / 2,
                ['üéâ', 'üéä', '‚ú®', 'üåü', 'üíï', 'üíñ', 'üèÜ', 'ü•á'],
                12
            );
        }

        // ÂõûÁ≠î„Åã„ÇâÂâäÈô§
        function removeFromAnswer(index) {
            if (isCorrectAnswerShowing || isAnswerButtonUsed) return;
            
            currentAnswer.splice(index, 1);
            updateAnswerDisplay();
            soundSystem.playClick();
            soundSystem.vibrate([30]);
        }

        // ÂõûÁ≠î„Çí„ÇØ„É™„Ç¢
        function clearAnswer() {
            currentAnswer = [];
            hasCheckedCurrentProblem = false;
            updateAnswerDisplay();
            soundSystem.playClick();
            soundSystem.vibrate([50]);
        }

        // Á≠î„Åà„Çí„ÉÅ„Çß„ÉÉ„ÇØÔºàË§áÊï∞Ê≠£Ëß£„Éë„Çø„Éº„É≥ÂØæÂøúÔºâ
        function checkAnswer() {
            if (!currentProblem || currentAnswer.length === 0) {
                showFeedback('Á≠î„Åà„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠ ü§î', 'incorrect');
                return;
            }

            if (hasCheckedCurrentProblem) {
                showFeedback('„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØÊ¨°„ÅÆÂïèÈ°å„Å∏ ‚û°Ô∏è', 'incorrect');
                return;
            }

            hasCheckedCurrentProblem = true;
            totalCount++;
            
            // Ë§áÊï∞„ÅÆÊ≠£Ëß£„Éë„Çø„Éº„É≥„Çí„ÉÅ„Çß„ÉÉ„ÇØ
            const isCorrect = currentProblem.answer.some(correctPattern => 
                arraysEqual(currentAnswer, correctPattern)
            );

            if (isCorrect) {
                correctCount++;
                comboCount++;
                
                animateCorrectAnswer();
                
                showFeedback(`Ê≠£Ëß£ÔºÅüéâ „Ç≥„É≥„Éú${comboCount}`, 'correct');

            } else {
                comboCount = 0;
                soundSystem.playIncorrect();
                soundSystem.vibrate([80, 40, 80]);
                
                const correctStr = currentProblem.answer[0].join('');
                showFeedback(`ÊÆãÂøµ...Ê≠£Ëß£„ÅØ„Äå${correctStr}„Äç„Å†„Çà üòÖ`, 'incorrect');
            }

            updateScoreDisplay();
        }

        // Ê≠£Ëß£„ÇíË°®Á§∫„Åô„ÇãÊñ∞Ê©üËÉΩÔºà„ÉÜ„Ç≠„Çπ„ÉàË°®Á§∫ÁâàÔºâ
        function showCorrectAnswer() {
            if (!currentProblem) {
                showFeedback('ÂïèÈ°å„ÇíÈÅ∏„Çì„Åß„Å≠ üíï', 'incorrect');
                return;
            }

            soundSystem.playMagical();
            soundSystem.vibrate([100, 50, 100, 50, 100]);

            const correctAnswer = currentProblem.answer[0].join('');
            
            // ÂõûÁ≠î„Ç®„É™„Ç¢„Å´Áõ¥Êé•„ÉÜ„Ç≠„Çπ„ÉàË°®Á§∫
            const answerContent = document.getElementById('answerContent');
            const answerArea = document.getElementById('answerArea');
            
            answerArea.classList.add('has-answer');
            isAnswerButtonUsed = true;
            
            answerContent.innerHTML = `
                <div class="answer-button-display">
                    <span>Ê≠£Ëß£: ${correctAnswer}</span>
                </div>
            `;

            const answerBtn = document.getElementById('answerBtn');
            const rect = answerBtn.getBoundingClientRect();
            particleSystem.createExplosion(
                rect.left + rect.width / 2,
                rect.top + rect.height / 2,
                ['üìñ', '‚ú®', 'üí°', 'üåü', 'üíï'],
                4
            );
        }

        // ÈÖçÂàóÊØîËºÉ
        function arraysEqual(a, b) {
            return a.length === b.length && a.every((val, i) => val === b[i]);
        }

        // „Éí„É≥„ÉàË°®Á§∫
        function showHint() {
            if (!currentProblem) return;

            soundSystem.playClick();
            soundSystem.vibrate([100, 50, 100]);

            const hint = currentProblem.answer[0][0];
            showFeedback(`„Éí„É≥„Éà: ÊúÄÂàù„ÅØ„Äå${hint}„Äç„Å†„Çà üí°`, 'correct');

            const questionInAnswer = document.getElementById('questionInAnswer');
            const rect = questionInAnswer.getBoundingClientRect();
            particleSystem.createExplosion(
                rect.left + rect.width / 2,
                rect.top + rect.height / 2,
                ['üí°', '‚ú®', 'üåü'],
                3
            );
        }

        // Ê¨°„ÅÆÂïèÈ°å
        function nextProblem() {
            hasCheckedCurrentProblem = false;
            document.getElementById('celebration').classList.remove('show');
            loadProblem();
            
            soundSystem.playMagical();
            soundSystem.vibrate([100, 50, 100]);
        }

        // „Çπ„Ç≥„Ç¢Ë°®Á§∫Êõ¥Êñ∞
        function updateScoreDisplay() {
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('totalCount').textContent = totalCount;
            document.getElementById('comboCount').textContent = comboCount;
        }

        // „Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØË°®Á§∫
        function showFeedback(message, type) {
            const feedback = document.getElementById('feedback');
            feedback.textContent = message;
            feedback.className = `feedback ${type} show`;
            
            setTimeout(() => {
                feedback.classList.remove('show');
            }, 3000);
        }

        // ÂàùÊúüÂåñÂÆüË°å
        document.addEventListener('DOMContentLoaded', () => {
            initGame();
        });
    </script>
</body>
</html>